# Kubernetes In Action - Chapter 3
## 1. 파드이해
파드는 책에서 언급된 것처럼 가상머신과 매우 유사하게 느껴졌다
내가 이해한 파드와 가상머신과의 비교를 그림으로 간단히 표현해 보았다

![image](https://user-images.githubusercontent.com/98390642/154267003-d4597e40-037e-40cc-8a8a-52a43da07b49.png)

프로세스는 컨테이너당 하나를 가지도록 설정해야합니다.
이 컨테이너들이 모여서 파드를 구성하게 되는데

프로세스를 컨테이너 별로 나눈 이유는 주로 로그관리 파악과 개별 프로세스의 문제 발생시 프로세스 관리 매커니즘 적용에 대해
컨테이너 별로 하나의 프로세스를 가져가는 것이 매우 유용함

컨테이너는 동일한 파드안에서는 동일한 네트워크 네임스페이스와 UTS 네임스페이스 공유함
네임스페이스 관련 자료 참조 :
https://bluese05.tistory.com/11?category=561065

Hypervisor는 Hardware resource 를 가상화 한다. 
Hypervisor 위에 올라가는 Guest OS 에는 가상화 된 형태의 H/W 를 제공하게 되며, 
따라서 각각의 Guest OS는 완전한 다른 환경으로 분리된다. 
하지만 namespace의 경우에는 Hardware resource 레벨의 가상화가 아니다.
 동일한 OS와 동일한 kernel 에서 작동하게 되며, 단지 각각의 고립된 사용 환경만 제공되는 것이다.



### 1-1. 플랫 네트워크
파드는 기본적으로 플랫 네트워크 구조임

링크 참조
https://seankim.life/2021/06/16/flat-network-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0/

교재에서는 다음 그림과 같이 플랫 네트워크를 표현하였음
![image](https://user-images.githubusercontent.com/98390642/154267406-68b85d84-26e4-467a-9de7-740994080fc7.png)

c클래스 기반 ip address 많이 사용하여 순간 다른 네트워크 간에 통신이 가능한 이유가 궁금하였으나
플랫 네트워크라면 B클래스 기반으로 해석됨 



### 1-2. 파드 애플리케이션
파드는 특정한 어플리케이션만 호스팅함
여기서 가상머신과 가장 큰 차이점이라고 생각이든다

하나의 파드안에 여러 애플리케이션을 담을 수 있지만 적절한 구성은 아니다

그이유는 첫번째 리소스 활용 문제이다 두개의 어플리케이션이 하나의 pod에 있는한
두개의 어플리케이션은 서로 다른 노드에서 실행 될 수 없다

두번째로는 scale up, scale out의 문제이다
파드는 스케일링의 기본단위다. 쿠버네티스에서는 개별 컨테이너를 수평으로 확장할 수 없는데
애플리케이션마다 스케일링 요구 사항이 다를 수 있어 컨테이너르르 개별적으로 스케일링하는 것이 필요하다면
별도 파드에 배포해야함

파드에서 여러 컨테이너를 사용하는 경우는 로그 로테이터와 수집기, 데이터 프로세서, 통신 어댑터 등 
사이드카 컨테이너가 구성되는 경우이다. 

1파드 n컨테이너 결정시 체크

컨테이너를 함께 실행해야하는가? 서로 다른호스트에서 실행 가능한가
여러 컨테이너가 모여 하나의 구성요소를 나타내는가 혹은 개별적인 구성요소인가
컨테이너가 함께 혹은 개별적으로 스케일링 돼야하는가

참고바란다.



## 2. YAML 또는 JSON 디스크립터로 파드 생성
쿠버네티스는 REST API 엔트포인트에 JSON 혹은 YAML 매니페스트를 전송해서 쿠버네티스 리소스들을 생성함

REST API는 다양하게 사용되는것같다
현재 주로 다루고있는 NSX-T Data Center 솔루션에서도 API에 대해 만져보았는데
같을 결을 가지고 있는것같다.

https://developer.vmware.com/apis/1124/nsx-t


파드를 정의하는 주요부분에서는 
Metadata, Spec, Status이며 Status의 경우 현재 파드상태를 보여주며 파드 생성시에는 없어도 생성가능한 부분이다

Kubectl explain pods 명령어로 파드속성에 관한 설명을 요청할 수 있다.


### 2-1. 포트포워딩
해당 책 내용에서 port-forwarding을 이용해서 로컬머신에서 특정 파드에 서비스없이 접근 가능하도록 설정하였는데
해당 내용이 동작 가능하기 위해서는 로컬머신(가상머신) 내부에 쿠버네티스 클러스터를 구성했을때 가능한것으로
보인다. 미니쿠배로 쿠버네티스 환경을 만들어보았다면 충분히 가능할듯

![image](https://user-images.githubusercontent.com/98390642/154267864-0dce8147-25e7-4bc0-9c79-8f84d6ee793f.png)

